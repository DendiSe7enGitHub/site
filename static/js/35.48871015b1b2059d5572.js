webpackJsonp([35],{zXIH:function(s,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var _={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("hr"),s._v(" "),t("h2",{attrs:{id:"name%3A-2019-03-20-javascriptlayout%3A-posttitle%3A-'%5B%E5%89%8D%E7%AB%AF%E6%80%AA%E8%B0%88_3%5D-%E4%BB%8E-filter-%E8%81%8A%E5%88%B0-promise'date%3A-2019-03-20categories%3A-javascripttags%3A-%5Bjavascript%5Dcoverimg%3A-'http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F88b26e1cgy1g4z8rrnn9gj22o0400u0y.jpg'info%3A-''"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#name%3A-2019-03-20-javascriptlayout%3A-posttitle%3A-'%5B%E5%89%8D%E7%AB%AF%E6%80%AA%E8%B0%88_3%5D-%E4%BB%8E-filter-%E8%81%8A%E5%88%B0-promise'date%3A-2019-03-20categories%3A-javascripttags%3A-%5Bjavascript%5Dcoverimg%3A-'http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F88b26e1cgy1g4z8rrnn9gj22o0400u0y.jpg'info%3A-''","aria-hidden":"true"}},[s._v("#")]),s._v(" name: 2019-03-20-javascript\nlayout: post\ntitle: '[前端怪谈_3] 从 filter 聊到 Promise'\ndate: 2019-03-20\ncategories: JavaScript\ntags: [JavaScript]\ncoverimg: 'http://ww1.sinaimg.cn/large/88b26e1cgy1g4z8rrnn9gj22o0400u0y.jpg'\ninfo: ''")]),s._v(" "),t("h2",{attrs:{id:"%E5%89%8D%E8%A8%80"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E5%89%8D%E8%A8%80","aria-hidden":"true"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),t("p",[s._v("在学习前端的时候，我总是能听到很多高级词汇，比如今天会聊到的 "),t("em",[s._v("函数式编程(Functional Programming)")]),s._v(" & "),t("em",[s._v("高阶函数 (Higher-order function)")]),s._v(" 。\n但是当你真正的理解什么是 "),t("em",[s._v("函数式编程")]),s._v(" & "),t("em",[s._v("高阶函数")]),s._v(" 的时候，也许会发现，你几乎每天都会用到它，只是你不知道那就是高阶函数 / 函数式编程。")]),s._v(" "),t("h2",{attrs:{id:"javascript-%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript-%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0","aria-hidden":"true"}},[s._v("#")]),s._v(" JavaScript 中的函数")]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v("javascript")]),s._v(" 中，函数是一种值，举个例子：")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" double = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" ("),t("span",{staticClass:"hljs-params"},[s._v("x")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" x * "),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v("\n}\n")])]),s._v(" "),t("p",[s._v("我们把一个函数作为值，赋给了变量 "),t("code",[s._v("double")]),s._v(" ,这在我们的代码中很常见对吗？")]),s._v(" "),t("p",[s._v("你是不是经常会听到或者看到这样一句话："),t("em",[s._v("“在 JavaScript 中函数是一等公民”")])]),s._v(" "),t("p",[s._v("粗看很不好理解，但是它的意思很简单：函数和 字符串/"),t("code",[s._v("number")]),s._v(" 没有什么不一样，它可以声明为变量，也可以"),t("em",[s._v("作为参数传入到其他函数中。")])]),s._v(" "),t("h2",{attrs:{id:"%E4%BB%80%E4%B9%88%E6%98%AF%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%EF%BC%9F"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AF%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%EF%BC%9F","aria-hidden":"true"}},[s._v("#")]),s._v(" 什么是高阶函数？")]),s._v(" "),t("p",[s._v("什么是高阶函数？其实上一段我们已经说过了，我们可以把函数A作为参数传入到另一个函数B中，那么接收函数作为参数的函数B，就是 "),t("em",[s._v("高阶函数")]),s._v(" ,这只是方便大家理解，高阶函数的定义是：")]),s._v(" "),t("p",[t("em",[s._v('"一个函数的参数是另一个函数，或者一个函数的返回值是另一个函数"')])]),s._v(" "),t("h2",{attrs:{id:"%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%E7%9A%84%E4%BE%8B%E5%AD%90"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%E7%9A%84%E4%BE%8B%E5%AD%90","aria-hidden":"true"}},[s._v("#")]),s._v(" 高阶函数的例子")]),s._v(" "),t("h3",{attrs:{id:"filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#filter","aria-hidden":"true"}},[s._v("#")]),s._v(" filter")]),s._v(" "),t("p",[s._v("说到 "),t("code",[s._v("filter()")]),s._v(" 你肯定不陌生，他接收一个回调函数作为它的参数，所以它是一个典型的高阶函数，举个例子：")]),s._v(" "),t("p",[s._v("我们有这么一个数组，要筛选出对应 "),t("code",[s._v("category")]),s._v(" 为 "),t("code",[s._v("html&css")]),s._v(" 的书籍。")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" books = [\n  {"),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'gitbook'")]),s._v(","),t("span",{staticClass:"hljs-attr"},[s._v("category")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'git'")]),s._v("},\n  {"),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'reactbook'")]),s._v(","),t("span",{staticClass:"hljs-attr"},[s._v("category")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'react'")]),s._v("},\n  {"),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'vuebook'")]),s._v(","),t("span",{staticClass:"hljs-attr"},[s._v("category")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'vue'")]),s._v("},\n  {"),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'cssbook'")]),s._v(","),t("span",{staticClass:"hljs-attr"},[s._v("category")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v("},\n  {"),t("span",{staticClass:"hljs-attr"},[s._v("name")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'htmlbook'")]),s._v(","),t("span",{staticClass:"hljs-attr"},[s._v("category")]),s._v(":"),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v("},\n  ]\n")])]),s._v(" "),t("p",[s._v("传统的写法是这样:")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" html_css_books = []\n"),t("span",{staticClass:"hljs-keyword"},[s._v("for")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" i = "),t("span",{staticClass:"hljs-number"},[s._v("0")]),s._v("; i < books.length; i++) {\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v("(books[i].category === "),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v("){\n    html_css_books.push(books[i])\n  }\n}\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(html_css_books)\n")])]),s._v(" "),t("p",[s._v("我相信几乎没有人会选择上面的方式，大部分人都会用 filter")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" html_css_books = books.filter("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(")")]),s._v("{"),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" item.category === "),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v("})\n")])]),s._v(" "),t("p",[s._v("当然我们还可以用箭头函数来缩减一些代码：")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" html_css_books = books.filter("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item.category === "),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v(")\n")])]),s._v(" "),t("p",[s._v("我知道这是一个大家都明白的例子，从这里你能看到几个高阶函数的好处？")]),s._v(" "),t("ul",[t("li",[s._v("更短的代码")]),s._v(" "),t("li",[s._v("更少的错误")]),s._v(" "),t("li",[s._v("更多的复用")])]),s._v(" "),t("p",[s._v("第三点你可能不同意，因为你可能会说，我们没有复用任何代码啊？但如果我们把传入的filter的回调函数抽离出来呢？因为真正决定要过滤哪些数据的是这个部分。")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" is_html_css_books = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item.category === "),t("span",{staticClass:"hljs-string"},[s._v("'html&css'")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" is_git_books = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item.category === "),t("span",{staticClass:"hljs-string"},[s._v("'git'")]),s._v("\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" is_not_git_books = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("item")]),s._v(" =>")]),s._v(" item.category !== "),t("span",{staticClass:"hljs-string"},[s._v("'git'")]),s._v("\n\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" html_css_books = books.filter(is_html_css_books)\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" git_books = books.filter(is_git_books)\n"),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" not_git_books = books.filter(is_not_git_books)\n")])]),s._v(" "),t("p",[s._v("清晰又简洁不是吗？")]),s._v(" "),t("h3",{attrs:{id:"filter-%26-map-%26-find-%26-reduce"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#filter-%26-map-%26-find-%26-reduce","aria-hidden":"true"}},[s._v("#")]),s._v(" filter & map & find & reduce")]),s._v(" "),t("p",[s._v("这些都是我们常见的高阶函数，但是它们的用法各不相同")]),s._v(" "),t("table",[t("tr",[t("th",[s._v("函数")]),s._v(" "),t("th",[s._v("返回值")])]),s._v(" "),t("tr",[t("td",[s._v("filter")]),s._v(" "),t("td",[s._v("大数组 => 小数组")])]),s._v(" "),t("tr",[t("td",[s._v("map")]),s._v(" "),t("td",[s._v("数组 => 长度相等的数组")])]),s._v(" "),t("tr",[t("td",[s._v("find")]),s._v(" "),t("td",[s._v("数组 => 单个元素")])]),s._v(" "),t("tr",[t("td",[s._v("reduce")]),s._v(" "),t("td",[s._v("数组 => 大数组/小数组/单个元素/长度相等的数组/字符串/Number/其他值")])])]),s._v(" "),t("p",[t("code",[s._v("reduce")]),s._v(" 有很多玩法，甚至它可以取代我们刚刚说的三种高阶函数，下一篇我们会聊聊 "),t("code",[s._v("reduce")]),s._v(" 的内容。接下来我们看看，高阶函数有可能会遇到的问题，又如何去解决。")]),s._v(" "),t("h2",{attrs:{id:"%E9%97%AE%E9%A2%98-%26-%E8%A7%A3%E5%86%B3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E9%97%AE%E9%A2%98-%26-%E8%A7%A3%E5%86%B3","aria-hidden":"true"}},[s._v("#")]),s._v(" 问题 & 解决")]),s._v(" "),t("h3",{attrs:{id:"%E9%97%AE%E9%A2%98"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E9%97%AE%E9%A2%98","aria-hidden":"true"}},[s._v("#")]),s._v(" 问题")]),s._v(" "),t("p",[s._v("我们一起来看这样一个场景")]),s._v(" "),t("p",[s._v("比如我们需要计算 a, b 两个值的和的两倍再加3，我们可能会定义两个函数")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("double")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("a, b")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" (a + b) * "),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v("\n  }\n\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("add3")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("a")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" a + "),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v("\n}\n")])]),s._v(" "),t("p",[s._v("那么我们会这样调用：")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[s._v("add3(double("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(","),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v("))\n")])]),s._v(" "),t("p",[s._v("但是如果我们需要多加几次3呢？")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[s._v("add3(add3(add3(add3(add3(double("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(","),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v("))))))\n")])]),s._v(" "),t("p",[s._v("是的，虽然计算没有错误，但是我们的可读性大大降低了，那面对这样的情况如何处理呢？")]),s._v(" "),t("h3",{attrs:{id:"%E8%A7%A3%E5%86%B3%EF%BC%9A%E9%93%BE%E5%BC%8F%E4%BC%98%E5%8C%96"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E8%A7%A3%E5%86%B3%EF%BC%9A%E9%93%BE%E5%BC%8F%E4%BC%98%E5%8C%96","aria-hidden":"true"}},[s._v("#")]),s._v(" 解决：链式优化")]),s._v(" "),t("p",[s._v("解决嵌套的第一种方法，就是拆解嵌套，链式调用，就像一条链子一样，一环套一环，将上次的结果，作为下次的参数。")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" chainObj = {\n  double(a,b) {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".temp = (a + b) * "),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(";\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(";\n  },\n  add3() {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".temp += "),t("span",{staticClass:"hljs-number"},[s._v("3")]),s._v(";\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(";\n  },\n  getValue() {\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" value = "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".temp;\n    "),t("span",{staticClass:"hljs-comment"},[s._v("// 记得这里要初始化temp值")]),s._v("\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".temp = "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v(";\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("return")]),s._v(" value;\n  }\n};\n")])]),s._v(" "),t("p",[s._v("所以我们上面的嵌套现在可以这样写:")]),s._v(" "),t("pre",{staticClass:"hljs"},[t("code",[s._v("chainObj.double().add3().add3().add3().add3().getValue()\n")])]),s._v(" "),t("h3",{attrs:{id:"%E8%A7%A3%E5%86%B3%EF%BC%9Apromise"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E8%A7%A3%E5%86%B3%EF%BC%9Apromise","aria-hidden":"true"}},[s._v("#")]),s._v(" 解决：Promise")])])}]},v=t("VU/8")(null,_,!1,null,null,null);a.default=v.exports}});
//# sourceMappingURL=35.48871015b1b2059d5572.js.map